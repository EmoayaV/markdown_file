## 1. 摘要abs和导言intro

[文章链接](C:\Users\Emoaya\Desktop\文章\精读文章\15.【2017】【ICML】【Kuniaki Saito】【用伪标签和三分类器训练】Asymmetric Tri-training for Unsupervised Domain Adaptation.pdf)

### 1.1 在干什么、有什么贡献、什么结论

**背景：目标域无监督。**

之前的方法基本都是基于差异的方法，减小源域的分类损失，减小源域和目标域的差异，**但是对于无标签的目标域数据无法知道分类器是否将其正确分类**，于是作者就用伪标签来判断目标域的数据是否正确分类，依次减小其损失。

过去的那些半监督学习方法旨在通过最小化域之间的差异以及源域上的category loss来获得域不变特征(domain-invariant features)。理论上，一般不存在在目标域与源域都表现好的分类器。直接对目标域的判别特征进行学习是很困难的，所以从**伪标签学习**入手。

研究域适应，都希望能够学到**域不变的特征**，也就是说，假如现在是分类的任务，希望学习到分类器在不同的域都能够表现良好。实际情况是，这是很难的事情，因为不同域的具有不同的分布，具有各自具体域的特性。关于这方面的解决方法很多，看下本文Asymmetric Tri-training的方法吧，**即用不对称的三个网络，其中两个网络用来生伪标签，另外一个网络从伪标签数据中来学习，生成target域的目标表示。**
## 2. 网络结构

<img src="D:\markdown file\截图\image-20221014121304589.png" alt="image-20221014121304589" style="zoom:50%;" />

**具体看图：**

先用源域上有标签的数据训练两个不同的分类器，然后目标上无label的图片分别丢到分类器中，分别产生的输出，由于有可能产生false label，所以还需要去挑选。总之中间图表示的意思是，让两个分类器产生无label的图片的伪标签 pseudo-labels，最后利用得到伪标签的目标域数据，去训练第三个分类网络。具体细节看下文：


![image-20221014122749672](D:\markdown file\截图\image-20221014122749672.png)

**网络结构：**

F为共享的特征提取器，F1、F2为生成伪标签的两个分类器，Ft为学习目标域的特征表达的分类器。

**训练过程：目标是训练Ft这个分类器**

1.首先，用源数据S训练F1、F2和Ft网络，F1和F2用下面公式（1）的损失，Ft用普通的交叉熵损失。

2.训练完之后用F1、F2 为目标域生成伪标签，有两个条件，当两个分类器生成的标签一致的时候该标签成立，或者某一个分类器生成的标签的置信度大于一定的阈值如0.95时成立。其目的在于让生成的伪标签尽量真，分类器需要达到一定的置信度。如果两个条件都满足，则把目标域样本和伪标签对，放入伪标签数据集。为了缓和在伪标签上的过拟合的问题，其中用到了重采样等方法。

3.**把生成的伪标签数据集和源域数据集合并**，放入F1，F2分类器用公式（1）训练，（这应该是为了产生更好的伪标签），Ft只用伪标签数据集训练，用简单的交叉熵损失进行更新。

4.训练完成后，F能够学习到目标域的特征表示，分类器Ft也能够目标域数据进行分类。

<img src="D:\markdown file\截图\image-20221014124823260.png" alt="image-20221014124823260" style="zoom:50%;" />

**Loss Function：**

**F1和F2的损失：**因为我们想让F1和F2分类器是不同的两个分类器，或者是从不同的角度分类，为了保证两个分类器尽量从不同的视角来训练，所以加入正则项 W1^T^W2，W1、W2为F1、F2全链接层的权重。用W1^T^W2的大小进行约束，会让W1、W2尽量正交，收敛于不同的局部最小值。有了这个损失，F1、F2网络将从不同的特性中学习。Ly是交叉熵损失，组成部分为（F1+F）与y的交叉熵，(F2+F)与y的交叉熵，这部分是训练F1和F2两个分类器，以便后续生成伪标签。

**Ft的损失：**简单的交叉熵损失。

<img src="D:\markdown file\截图\image-20221014122810924.png" alt="image-20221014122810924" style="zoom:50%;" />

**算法过程：**

1）先看算法过程

* 用源域数据分别训练F, F1, F2, Ft
* 把target数据丢入F1和F2，生成pseudo-labels（伪标签），其中需要满足两个条件：两个网络输出是同一个类别；具有足够高的置信度，0.9/0.95。
* 迭代过程，label数据和 pseudo-labels数据继续训练F, F1, F2； pseudo-labels数据训练F，Ft
* 训练完成后，F能够学习到目标域的特征表示，分类器Ft也能够目标域数据进行分类。

2）具体的实现细节，看代码，做实验

* 做两个实验，第一，重新训练网络，多看几层特征分布
* 第二、合成图像–>真实图像实验    
* 集体讨论，有什么可改进的地方
