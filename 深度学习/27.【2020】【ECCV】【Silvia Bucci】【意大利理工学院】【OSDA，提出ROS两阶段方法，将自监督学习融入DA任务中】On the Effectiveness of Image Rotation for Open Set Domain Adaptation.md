## 1. 摘要abs和导言intro

[文章链接](C:\Users\Emoaya\Desktop\文章\精读文章\27.【2020】【ECCV】【Silvia Bucci】【意大利理工学院】【OSDA，提出ROS两阶段方法，将自监督学习融入DA任务中】On the Effectiveness of Image Rotation for Open Set Domain Adaptation.pdf)

### 1.1 在干什么、有什么贡献、什么结论

本文主要是解决Open Set Domain Adaptation (OSDA)的问题，这个问题其实和Universal DA的问题差不多。

OSDA可以通过先分离已知/未知目标样本，然后将已知目标样本与源数据对齐来处理，我们**提出了一种名为基于旋转的开放集 Rotation-based Open Set (ROS)的两阶段方法。**

此外，我们**使用一种新的开放集度量**来评估性能。

**OSDA面临的两大挑战：**

1.负迁移：当整个源域和目标域的分布被强行匹配时，会发生负迁移，从而导致未知目标样本与源数据错误对齐，为了避免这个问题，跨域适应应该只关注共享Cs类，

2.如何区分已知类和未知类。

### 1.2 ==自监督学习的简介==

**自监督学习将监督学习的技术应用到没有外部监督的问题上。**其思想是操纵数据来生成对人工任务的监督，这有助于学习有用的特征表示。

==实际上，本文的作者把基于重构的DA方法也算作基于自监督的方法 。==

### 1.3 ==异常检测简介==

异常检测，也称为异常值或新颖性检测，旨在从一组正常样本中学习一个模型，从而能够检测出非分布(异常)实例。

## 2. 网络结构

![image-20221112201551502](D:\markdown file\截图\image-20221112201551502.png)

**训练流程：**

在第一阶段，我们通过训练模型对已知和未知的目标样本进行分离。这个问题可以被看为异常检测问题，其中未知样本被视为异常。

在第二阶段，我们减少源域和已知目标域之间的域偏移。这个问题也被看作为普通的CSDA问题。

我们使用自监督学习来解决这两个阶段的问题。更具体地说，我们使用了旋转分类这种自监督任务来解决对已知和未知的目标样本进行分离和减少源域和已知目标域之间的域偏移的问题。

最后，我们得到一个分类器，它预测每个目标样本要么属于一个已知类，要么作为未知类别拒绝它

**具体细节：**

阶段一，我们训练了两个分类器，分别是语义分类器C1和旋转分类器R1。旋转预测是根据编码器E产生的原始图像和旋转图像的特征相叠加来计算的，语义预测是只根据原始图像的特征来计算。具体的损失函数如下：

<img src="D:\markdown file\截图\image-20221112203241363.png" alt="image-20221112203241363" style="zoom:50%;" />

不用管具体的细节，公式(1)语义分类器的损失就是要预测是什么类别，所以就是简单的CE损失。公式(2)旋转分类器就是要预测图片转了多少度，前半部分CE损失来确定这个图片是转了多少度的哪一类的图片，即如果有10类，分别转了4个角度，那么对于这个CE损失，就是判断10*4=40个类别，后半部分的中心损失(center loss)进一步鼓励网络在保持不同类的特征的同时最小化类内部的变化。

之后使用旋转分类器输出作为度量来检测未知类别样本，具体来说就是对所有目标域的样本，利用编码器E和旋转分类器R1来计算一个normality  score，以此来区分已知类和未知类。其中normality  score的计算如下所示：

<img src="D:\markdown file\截图\image-20221112205709022.png" alt="image-20221112205709022" style="zoom: 50%;" />

![image-20221112205820851](D:\markdown file\截图\image-20221112205820851.png)

不要去在意细节，总之就是判断已知类和未知类。

阶段二，与阶段I类似，网络由编码器E，一个旋转分类器R2和一个语义分类器C2组成，编码器从上一阶段继承而来。两个分类器也利用了之前训练阶段的分类器，但与第一阶段相比有两个关键区别：(1)C1只判断源域的类别，Cs个类别，C2除了判断源域的类别之外，还要判断已知类和未知类，一共Cs+1个类别。(2)R1是一个输出为(4 × |Cs|)维的多旋转分类器，R2是一个输出为4维的旋转分类器，就是说R2只用判断转了多少度就行。其中loss如下：

![image-20221113133138299](D:\markdown file\截图\image-20221113133138299.png)

## 创新点

==作者的这个方法属于基于自监督的DA问题。==

==自监督是数据能够提供监督信息的一种无监督学习方式==

==自监督学习主要是利用辅助任务（pretext）从大规模的无监督数据中挖掘自身的监督信息，通过这种构造的监督信息对网络进行训练，从而可以学习到对下游任务有价值的表征。==

作者这里在分类任务的基础上，进一步加了一个旋转分类的子任务，并且这个子任务的输出结果还可以成为我判断未知类别的度量，什么意思呢？就是说当我们面对两个相似的类别，比如已知类家猫和未知类野猫，如果在大体上我们分不开(都是猫)，那么我们就用他们其中的一个属性作为依据来将他们分开，我可以训练个分类器判断猫会不会抓老鼠，如果会抓老鼠就是野猫，不会抓老鼠就是家猫，我们根据这个子任务输出的结果来衡量是否为已知未知类的依据，这篇文章的思想大体如此，实际上现在这种做法也成为了主流。

==还有细粒度图像分类任务，和零样本任务也都是用到了属性，其实是相关联的。==

[13.【2009】【CVPR】【Christoph H. Lampert】【是零样本学习ZSL的开山之作，为类标签引入属性标签，来预测训练集没有的未知类】Learning To Detect Unseen Object Classes by Between-Class Attribute Transfer](./13.【2009】【CVPR】【Christoph H. Lampert】【是零样本学习ZSL的开山之作，为类标签引入属性标签，来预测训练集没有的未知类】Learning To Detect Unseen Object Classes by Between-Class Attribute Transfer.md)

[8.【2017】【ICCV】【Timnit Gebru、Hoffman、Li Fei-Fei】【斯坦福大学】【采用DA的方法将softlabel用到细粒度图像分类中】Fine-grained Recognition in the Wild A Multi-Task Domain Adaptation Approach](./8.【2017】【ICCV】【Timnit Gebru、Hoffman、Li Fei-Fei】【斯坦福大学】【采用DA的方法将softlabel用到细粒度图像分类中】Fine-grained Recognition in the Wild A Multi-Task Domain Adaptation Approach.md)