[文章链接](C:\Users\Emoaya\Desktop\文章\精读文章_时序异常检测\1.【2019】【arXiv】【Raghavendra Chalapathy】【异常检测综述】Deep Learning for Anomaly Detection a survey.pdf)

## 1. 摘要abs和导言intro

### 1.1 什么是异常

在数据挖掘和统计文献中，异常也被称为异常、偏差或异常值。

**实际上异常检测问题可以看作是一种Universal DA问题，异常就是目标域比源域多出来的类。**

可以参考以下的目标域无监督的Universal DA问题。

**背景：源域有标签，目标域无监督。**

**两个大挑战：**1.域偏移（domain shift），在公共类别中去对齐源域和目标域的特征（对应于时序异常检测问题中的消除噪声）2.类别偏移（category shift），如何分辨未知类（也就是分辨公共类别，也可以看作分辨异常）。其中分辨未知类是最难的任务，如果可以正确分辨那么就可以用传统的DA方法进行训练。

解决：

* 通过学习源域和目标域的域不变表示来对齐源域和目标域的分布

![image-20230414093533335](D:\markdown file\截图\image-20230414093533335.png)

![image-20230414094050014](D:\markdown file\截图\image-20230414094050014.png)

### 1.2 动机是什么

* 传统算法在图像(如医学图像)和序列数据集上的**异常值检测性能不佳，无法捕捉数据中的复杂结构**。
* 大规模异常检测的需求:随着**数据量的增加**，比如增加到千兆字节，传统方法几乎不可能扩展到如此大规模的数据来发现异常值。
* 深度异常检测(DAD)技术从数据中学习分层判别特征。**这种自动特征学习能力消除了领域专家开发手动特征的需要**，因此提倡在文本和语音识别等领域解决端到端获取原始输入数据的问题。
* **正常和异常(错误)行为之间的边界通常在多个数据域中没有精确定义**，并且在不断发展。缺乏定义良好的代表性正态边界，这对传统和基于深度学习的算法都构成了挑战。**（这里是否可以看作DA问题，比如说正常点是一个域，异常点是一个域）**
* 大量关于异常检测的研究是使用深度自编码器进行的，但缺乏对各种最适合给定数据集和应用领域的深度架构的全面调查。

### 1.3 场景是什么

* 欺诈检测 Fraud Detection
* 网络入侵检测 Cyber-Intrusion Detection
* 医疗异常检测 Medical Anomaly Detection
* 传感器网络异常检测 Sensor Networks Anomaly Detection
* 物联网(IoT)大数据异常检测 Internet Of Things (IoT) Big-data Anomaly Detection
* 日志异常检测 Log-Anomaly Detection
* 视频监控 Video Surveillance 
* 工业损害检测 Industrial Damage Detection 

### 1.4 方法有哪些

* 有监督方法 Supervised 
* 无监督方法 Unsupervised 
* 混合模型（?） Hybrid Models
* 单类神经网络 (?) one-Class Neural Networks 

### 1.5 场景分类、方法分类、模型分类的图

![image-20230407172952850](D:\markdown file\截图\image-20230407172952850.png)

![image-20230411151707176](D:\markdown file\截图\image-20230411151707176.png)

## 2. 根据不同方面将异常检测算法模型分类

### 2.1 根据输入数据集的数据类型

![image-20230411145324004](D:\markdown file\截图\image-20230411145324004.png)

* 输入数据集是序列
* 输入数据不是序列

***********

### 2.2 根据是否有标签

* 监督
* 半监督
* 无监督

#### 2.2.1 有监督的异常检测任务

有监督异常检测任务使用正常和异常数据实例的标签训练一个二分类器或多分类器。由于以下缺点，所以不用有监督的异常检测模型。

**缺点：**

- 是缺少可用的有标签的数据。
- 类别不平衡，正类实例的总数远远超过负类数据的总数（100样本，1个负样本，如果全部判为正确则准确率为99%）

#### 2.2.2 半监督的异常检测任务

在有足够的训练样本的情况下，正常类自编码器对于不寻常事件的正常实例会产生低重构误差。**（就是说异常的熵比正常的熵要大）**

#### 2.2.3 无监督深度异常检测

无监督深度异常检测技术仅基于数据实例的内在属性来检测异常值。**其中自编码器（AE）是所有无监督DAD模型的核心。**

***************

### 2.3 根据训练目标的不同

* 深度混合模型 Deep hybrid models (DHM)
* 单类神经网络 One class neural networks (OC-NN)

#### 2.3.1 深度混合模型

![image-20230411154156965](D:\markdown file\截图\image-20230411154156965.png)

深度混合模型使用自编码器（AE）作为特征提取器，经过自编码器提取的特征被输入到传统的异常检测算法，如单类SVM (OC-SVM)来检测异常值。在迁移学习成功地从大型数据集上预训练的模型中获得丰富的代表性特征之后，混合模型也将这些预训练的迁移学习模型作为特征提取器，并取得了巨大成功。（混合模型指的是深度学习网络的特征提取器+传统机器学习方法的混合）

**缺点：**

这些混合方法的一个显著缺点是缺乏为异常检测定制的可训练目标，因此这些模型无法提取丰富的差异特征来检测异常值。为了克服这一限制，引入了单类神经网络。**（简单来说就是仅仅进行特征提取，提取的特征不是专门用于异常检测的，就是说缺少损失函数→反向传播→更新网络的过程）**

#### 2.3.2 单类神经网络

该分类结合了深度网络提取逐步丰富的数据表示的能力，以及在正常数据周围创建紧密包络的单类目标。经过自编码器得到的特征是以One class neural network OC-NN目标而得到的，因此这种特征是专门只用于异常检测的。

****

### 2.4 根据异常的类型不同

![image-20230411160202180](D:\markdown file\截图\image-20230411160202180.png)

* 点异常 point anomalies
* 上下文异常 contextual anomalies
* 集合异常 collective anomalies

#### 2.4.1 点异常

![image-20230412084925628](D:\markdown file\截图\image-20230412084925628.png)

本文大部分工作集中在点异常上。点异常通常代表随机发生的不规则或偏差，可能没有特定的解释。

#### 2.4.2 上下文异常

上下文异常也称为条件异常（conditional anomaly），是在某些特定上下文中可以被视为异常的数据实例。上下文异常通过考虑上下文特征和行为特征来识别。

#### 2.4.3 集合异常

单个数据点的异常集合称为集合或组异常，其中孤立的每个单独点都表现为正常数据实例，而在组中观察时则表现出异常特征。

****

### 2.5 异常检测的输出（损失函数的输出）

异常检测方法产生的输出要么是异常分数，要么是二进制标签。

* 异常分数 anomaly score
* 二元标签 binary labels

#### 2.5.1 异常分数

异常值描述每个数据点的异常值*outlierness*水平。一般来说，异常分数比二分类标签透露更多的信息。例如，在深度SVDD方法中，决策得分是数据点到球体中心的距离的度量，远离中心的数据点被认为是异常的

#### 2.5.2 二元标签

有些技术可能会为每个数据实例分配正常或异常类别标签，而不是分配分数。无监督异常检测技术使用自编码器测量残差向量(即重构误差)的大小来获得异常分数，然后由领域专家对重构误差进行排序或阈值来标记数据实例。

## 3. 异常检测的应用

### 3.1 入侵检测 Intrusion Detection

![image-20230412091350585](D:\markdown file\截图\image-20230412091350585.png)

根据检测方法的不同，IDS（intrusion detection system）可分为基于特征的IDS和基于异常的IDS。使用基于特征的IDS检测新攻击的效率不高，因为没有特定的特征模式，因此基于异常的检测方法更受欢迎。

DAD技术在入侵检测中面临的一个挑战是异常的性质会随着时间的推移而不断变化，因为入侵者会调整他们的网络攻击来逃避现有的入侵检测解决方案。

* 基于主机的入侵检测系统（HIDS）
* 基于网络的入侵检测系统（NIDS）

#### 3.1.1 基于主机的入侵检测系统（HIDS）

![image-20230412092253820](D:\markdown file\截图\image-20230412092253820.png)

应用于HIDS的深度异常检测(Deep anomaly detection, DAD)技术需要处理可变长度和顺序的数据。DAD技术必须对序列数据建模或计算序列之间的相似性。表3说明了一些用于HIDS的成功DAD技术。

#### 3.1.2 基于网络的入侵检测系统（NIDS）

![image-20230412093140646](D:\markdown file\截图\image-20230412093140646.png)

NIDS系统通过检查每个网络数据包来监控整个网络的可疑流量（也是时序数据）。一些成功的DAD技术NIDS如表4所示。

#### 3.1.3 用于入侵检测的数据集

![image-20230412093506964](D:\markdown file\截图\image-20230412093506964.png)

****

### 3.2 时序中的异常检测

* 单变量时间序列 univariate time series
* 多变量时间序列 multivariate time series

多元时间序列由几个随时间变化的变量(或特征)组成。对于单变量时间序列，只有单个变量(或特征)随时间变化。

时间序列异常检测的挑战：

* 异常发生时缺乏明确的模式可以被定义。（如何定义异常？）
* 输入数据中的噪声严重影响算法的性能。
* 随着时间序列数据长度的增加，计算复杂度也随之增加。
* 时间序列数据通常是非平稳的、非线性的、动态演化的。因此，DAD模型应该能够实时检测异常（实时性？）

常用数据集：

![image-20230413112956848](D:\markdown file\截图\image-20230413112956848.png)

#### 3.2.1 时间序列异常检测的方法

* 单变量时间序列的异常检测方法

![image-20230413111805331](D:\markdown file\截图\image-20230413111805331.png)

* 单变量时间序列的异常检测方法

![image-20230413112838073](D:\markdown file\截图\image-20230413112838073.png)

****

## 4. 深度异常检测(DAD)模型

### 4.1 有监督的异常检测模型

监督异常检测从一组带标签的数据实例(训练)中学习分离边界（separating boundary），然后使用所学习的模型将测试实例分为正常类或异常类(测试)。

深度监督学习方法依赖于数据类的分离，而非监督学习方法则侧重于解释和理解数据的特征。

多类异常检测技术通过学习分类器来区分异常类和其他类。一般来说，基于监督深度学习的异常检测分类方案有两个子网络，一个是特征提取网络，另一个是分类器网络。（和DA相似？）

优点：

* 有监督DAD方法比半监督和无监督模型更准确。

* 基于分类的技术的测试阶段很快

缺点：

* 由于缺乏干净的数据标签，有监督的深度异常检测技术不像半监督和无监督方法那么受欢迎。（标签问题）

* 多类监督技术需要对各种正常类和异常实例进行准确的标记，而这通常是不可用的。（标签问题）

* 深度监督技术不能从异常数据中分离出高度复杂和非线性的特征空间。（负样本太少）

### 4.2 半监督的异常检测模型

![image-20230414084624341](D:\markdown file\截图\image-20230414084624341.png)

半监督或(单类分类)DAD技术假设所有训练实例只有一个类标签。半监督模型结构如表20所示。

优点：

* **在半监督学习模式下训练的生成对抗网络(GAN)显示出了巨大的前景，即使只有很少的标记数据。**
* 使用标记数据(通常是一类数据)可以比无监督技术产生相当大的性能改进。

### 4.3  深度混合模型

![image-20230414085636810](D:\markdown file\截图\image-20230414085636810.png)

在深度混合模型中，深度模型中学习到的代表性特征被输入到传统算法中，如一类径向基函数(RBF)、支持向量机(SVM)分类器。（就是把学习到的特征直接输入传统算法，混合模型指的是深度学习网络的特征提取器+传统机器学习方法的混合），混合模型采用两步学习。用于异常检测的深度混合模型结构如表21所示。

优点：

* 特征提取器显著降低了“维数灾难”，特别是在高维领域。
* 混合模型具有更强的可扩展性和计算效率，因为线性或非线性核模型是在降低输入维数的情况下运行的。

缺点：

* 混合方法是次优的，因为它不能影响特征提取器隐藏层中的表征学习，因为使用通用损失函数而不是定制的目标进行异常检测。**（简单来说就是仅仅进行特征提取，提取的特征不是专门用于异常检测的，就是说缺少损失函数→反向传播→更新网络的过程）**

### 4.4 单类神经网络

单类神经网络(OC-NN)将深度网络的能力与一类目标结合起来，以提取逐步丰富的数据表示，例如超平面(Chalapathy等人[2018a])或超球(Ruff等人[2018a])，以从异常值中分离所有正常数据点。单类神经网络通过优化为异常检测定制的目标函数，学习隐藏层中的数据表示。

优点：

* OC-NN模型联合训练深度神经网络，同时优化输出空间中的数据封闭超球或超平面。（就是说对混合模型进行了优化）

缺点：

* 对于高维输入数据，训练时间和模型更新时间可能更长。

### 4.5 无监督的异常检测模型

![image-20230414090923605](D:\markdown file\截图\image-20230414090923605.png)

表22提出了几种解决无监督异常检测挑战的模型结构。

优点：

* 学习固有的数据特征，以区分正常数据点和异常数据点。这种技术可以识别数据中的共性，并便于异常值检测。
* 数据集好获得。

缺点：

* 通常，在复杂的高维空间中学习数据中的共性是具有挑战性的。
* 在使用自动编码器时，选择正确的压缩程度(即降维)通常是一个超参数，需要调整以获得最佳结果。
* 无监督技术技术对噪声和数据损坏非常敏感，通常比有监督或半监督技术更不准确。

### 4.6 额外的异常检测方法

* 基于迁移学习的异常检测模型
* 基于零样本的异常检测模型
* 基于聚类的异常检测模型
* 基于深度强化学习的异常检测模型
* 基于统计的异常检测模型

