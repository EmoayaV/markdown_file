[文章链接](C:\Users\Emoaya\Desktop\文章\精读文章_时序异常检测\8.【2019】【arXiv】【Ya Su】【清华】【OmniAnomaly方法，SMD数据集】Robust Anomaly Detection for Multivariate Time Series.pdf)

## 1. 摘要abs和导言intro

问题：由于多元时间序列具有复杂的时间依赖性和随机性，其异常检测仍然是一个很大的挑战。监督学习方法[17,20]需要标记数据进行模型训练，并且只能识别已知异常类型的异常发生[13]（这个是没法解决的）。

解决：OmniAnomaly核心思想是利用随机变量连接、平面归一化流等关键技术，通过学习多变量时间序列的鲁棒表示来捕获多变量时间序列的正态模式，通过这些鲁棒表示重构输入数据，并利用重构概率判断异常。

场景：无监督的时序异常检测。

实验：在3个无监督数据集上进行了评估。

#### 面临的挑战

- 问题1：如何在考虑多变量时间序列的时间依赖性和随机性的情况下学习稳健的潜在表征。单靠随机模型很难捕捉多变量时间序列的长期依赖关系和复杂的概率分布。
- 解决1：我们的方法新颖地粘合了GRU (RNN的一种变体)和VAE采用以下两种关键技术。①为了明确地模拟潜在空间中随机变量之间的时间依赖性，我们提出了随机变量连接技术:随机变量之间的线性高斯状态空间模型[8]连接，以及随机变量与GRU潜在变量的连接。b)②为了帮助随机变量捕获输入数据的复杂分布，我们采用平面归一化流(planar NF)[18]，它使用一系列可逆映射来学习潜在随机空间中的非高斯后验分布。
- 问题2：第二个挑战是如何在随机深度学习方法下对检测到的实体级异常进行解释。
- 解决2：因此，在我们的方法中，检测到的实体异常可以用几个具有最低重建概率的单变量时间序列来解释。

## 2. 模型和方法

#### 网络结构

<img src="D:\markdown file\截图\image-20230524141053165.png" alt="image-20230524141053165" style="zoom:80%;" />

OmniAnomaly的整体结构由离线训练和在线检测两部分组成。数据预处理是离线训练和在线检测共享的模块。这种离线培训程序可以定期进行，例如每周一次或每月一次。在线检测模块存储训练好的模型。预处理后的新观测值(例如，时刻t的xt)可以输入在线检测模块，获取其异常评分。如果xt的异常得分低于异常阈值，则声明xt为异常，否则为正常。如果检测到xt为异常，我们通过估计和排序xt中每个维度的贡献(即重建概率)来解释它。

#### 具体的网络结构：

<img src="D:\markdown file\截图\image-20230524142723558.png" alt="image-20230524142723558" style="zoom:67%;" />

首先，它使用GRU捕获x空间中多变量观测值之间复杂的时间依赖性。

其次，我们应用VAE(一种流行的表示学习变分算法)将观测值(即x空间中的输入观测值)映射到随机(即z空间)变量。

OmniAnomaly的整体图形模型由两部分组成：qnet和pnet，在时刻t, xt是输入观测值，xt'是xt的重构，et和dt是GRU单元中的内存变量，zt是z空间变量，具有随机性，边表示变量之间的依赖关系。

<img src="D:\markdown file\截图\image-20230524142755223.png" alt="image-20230524142755223" style="zoom: 80%;" />

然后这个b1和b2是网络的整体架构，其实就是将VAE进行了修改。

![image-20220907114828023](D:\markdown file\截图\image-20220907114828023.png)









